generator client {
  provider = "prisma-client-js"
  output   = "../app/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  schemas  = ["neon_auth", "public"]
}

model users_sync {
  raw_json   Json
  id         String    @id @default(dbgenerated("(raw_json ->> 'id'::text)"))
  name       String?   @default(dbgenerated("(raw_json ->> 'display_name'::text)"))
  email      String?   @default(dbgenerated("(raw_json ->> 'primary_email'::text)"))
  created_at DateTime? @default(dbgenerated("to_timestamp((trunc((((raw_json ->> 'signed_up_at_millis'::text))::bigint)::double precision) / (1000)::double precision))")) @db.Timestamptz(6)
  updated_at DateTime? @db.Timestamptz(6)
  deleted_at DateTime? @db.Timestamptz(6)
  orders     orders[]

  @@index([deleted_at])
  @@schema("neon_auth")
}

model cart_items {
  id       Int  @id @default(autoincrement())
  quantity Int?

  @@schema("public")
}

model categories {
  id         Int        @id @default(autoincrement())
  name       String?
  updated_at DateTime?  @default(now()) @db.Timestamptz(6)
  created_at DateTime?  @default(now()) @db.Timestamptz(6)
  products   products[]

  @@schema("public")
}

model order_items {
  id                Int       @id @default(autoincrement())
  order_id          Int?
  product_id        Int?
  quantity          Int?
  price_at_purchase Int?
  orders            orders?   @relation(fields: [order_id], references: [id], onDelete: Cascade, map: "orders_order_id_fkey")
  products          products? @relation(fields: [product_id], references: [id], onDelete: Cascade, map: "orders_product_id_fkey")

  @@schema("public")
}

model orders {
  id           Int           @id @default(autoincrement())
  totat_amount Int?          @map("totat-amount")
  status       order_status?
  user_id      String?
  created_at   DateTime?     @default(now()) @db.Timestamptz(6)
  updated_at   DateTime?     @default(now()) @db.Timestamptz(6)
  order_items  order_items[]
  users_sync   users_sync?   @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@schema("public")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model products {
  id          Int           @id @default(autoincrement())
  name        String?
  description String?
  image_url   String?
  price       Int?
  stock       Int?
  category_id Int?
  updated_at  DateTime?     @default(now()) @db.Timestamptz(6)
  created_at  DateTime?     @default(now()) @db.Timestamptz(6)
  order_items order_items[]
  categories  categories?   @relation(fields: [category_id], references: [id], onDelete: Cascade)

  @@schema("public")
}

enum order_status {
  pending
  paid
  cancelled
  refunded

  @@schema("public")
}
